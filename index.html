<html>
	<head>
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

		<!-- jQuery library -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

		<!-- Latest compiled JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	</head>
	<body>
	    <div class="container">
            <div class="row">
                <div class="col-lg-2">
                	<select id = "Type">
					  <option value="Waterfall">Waterfall</option>
					  <option value="Fire">Fire</option>
					  <option value="Snow">Snow</option>
					  <option value="Ripples">Ripples</option>
					</select>

                </div>
                <div class="col-lg-8">
                    <canvas id="myCanvas" style="border:1px solid #000000;" height="1px" width="" margin = "10px 10px 10px 10px">
					</canvas>
			    </div>
                <div class="col-lg-2"></div>
            </div>
        </div>
		<script>
			//Canvas
			var canvas = document.getElementById("myCanvas");
			var windowWidth = $(window).width();
			var windowHeight = $(window).height();
			canvas.width = $("#myCanvas").parent().width();
			canvas.height = windowHeight - 20;
			var ctx = canvas.getContext("2d");
			ctx.fillStyle = "#FFFFFF";
			
			//Canvas Size
			var height = canvas.height;
			var width = canvas.width;
			
			//Colors
			var colorsStart = ["#FF0000","#0099ff","#66ff66","#ff0066","#6600cc","#ff6600","#00ffff","#ffff00","#00ffcc","#9966ff"];
			var colors = ["#FF0000","#0099ff","#66ff66","#ff0066","#6600cc","#ff6600","#00ffff","#ffff00","#00ffcc","#9966ff"];
			

			//Paramaters
			var drops = 100;
			var dropColor = [];
			var xpos = [];
			var ypos = [];
			var xdone = [];
			var numberXDone = 0;
			var display = document.getElementById('Type').value;
			
			//Initialize Drops
			for(i=0;i<drops;i++){
				xpos.push(Math.random()*width);
				ypos.push(Math.random()*height);
			}

			//Draw Drops
			function draw(){
				if(display == "Waterfall"){
					for(i=0;i<drops;i++){
						if(dropColor[i] !== 'undefined'){
							ctx.fillStyle = dropColor[i];
						}else{
							ctx.fillStyle = "#FFFFFF";
						}
						ctx.fillRect(xpos[i],ypos[i],2,6);
					}
				}
				
			}

			//Apply transfomation
			function gravity(){
				if(display == "Waterfall"){
					for(i=0;i<drops;i++){
						ypos[i] = ypos[i] + 1;
					}	
				}
				//console.log(ypos[1]);
 			}

 			//Stuff between Frames
			function reset(){
				if(display == "Waterfall"){
					for(i=0;i<drops;i++){
						if(ypos[i] >= height){
							xpos[i] = Math.random()*width;
							ypos[i] = (Math.random()*height)-100;
							xdone[i] = 1;
							numberXDone += 1;
							color();
						}
					}	
				}
				
			}

			//Changes color
			function color(){
				if(display == "Waterfall"){
					if(numberXDone < .75*width){
						dropColor[i] = colors[0];
					}else{
						colors.shift();
						numberXDone = 0;
						if(typeof(colors[0]) == "string"){
							dropColor[i] = colors[0];
							//console.log(colors[0]);
						}else{
							//console.log(colors[0]);
							for(j=0;j<colorsStart.length;j++){
								colors[j] = colorsStart[j];
								//console.log("I just reset the colors");
							}
							dropColor[j] = colors[0];
						}
					}
				}
				
			}

			//Checks for change in game type
			function checkChange(){
				display = document.getElementById('Type').value;
			}

			function clear(){
				ctx.fillStyle = "#FFFFFF";
				ctx.fillRect(0,0,width,height);
			}

			function nothing(){
				//This does nothing for sleeping
			}

			//Starts the Process
			function init(){
				setTimeout(nothing,10);
				draw();
				gravity();
				reset();
				checkChange();

				//console.log(display);
				//console.log(numberXDone);
			}

			//Clear canvas on change
			document.getElementById('Type').onchange = function(){
				setTimeout(clear,2);
			}

			//Defines the loop speed
			var myVar = setInterval(init,2);

		</script>
	</body>
</html>